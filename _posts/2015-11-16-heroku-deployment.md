---
layout: post
title:  "–î–µ–ø–ª–æ–π –Ω–∞ Heroku"
date:   2015-11-16
comments: true
---

### –ü—Ä–æ–ª–æ–≥

> 11:34:13. **CTO:** –¢—ã –¥–µ–ø–ª–æ–∏—à—å?
>
> 11:34:37. **–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ 1:** –î–µ–ø–ª–æ—é.
>
> 11:36:15. **CTO:** –î–µ–ø–ª–æ–∏—Ç—Å—è?
>
> 11:36:21. **–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ 1:** –ê–≥–∞.
>
> 11:37:13. **CTO:** –ó–∞–¥–µ–ø–ª–æ–∏–ª–æ—Å—å?
>
> 11:37:16. **–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ 1:** –ü–æ–≥–æ–¥–∏, —É–∂–µ —Ä–µ—Å—Ç–∞—Ä—Ç–∏—Ç—Å—è.
>
> 11:37:22. **CTO:** ‚Ä¶–ó–∞—Ä–µ—Å—Ç–∞—Ä—Ç–∏–ª–æ—Å—å?
>
> 11:37:25. **–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ 1:** –î–∞. –ú–æ–∂–µ—à—å —Å–∫–∞–∑–∞—Ç—å –ú–∞–∫—Å—É, –ø—É—Å—Ç—å –ø–æ—Å–º–æ—Ç—Ä–∏—Ç.
>
> 11:40:01. **CTO:** –ú–∞–∫—Å –≥–æ–≤–æ—Ä–∏—Ç, —á—Ç–æ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–µ–Ω—è–ª–æ—Å—å. –¢—ã —Ç–æ—á–Ω–æ –∑–∞–¥–µ–ø–ª–æ–∏–ª?
>
> 11:40:48. **–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ 1:** –ù—É —Ç–æ—á–Ω–æ —è –∑–∞–¥–µ–ø–ª–æ–∏–ª, –±–ª–∏–Ω. –£ –º–µ–Ω—è —Ä–∞–±–æ—Ç–∞–µ—Ç. –•–æ—Ç—è –ø–æ–≥–æ–¥–∏-–∫–∞, —á—Ç–æ –∑–∞‚Ä¶
>
> 11:41:03. **–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ 2:** –û, —Ä–µ–±—è—Ç–∞, –≤—ã —Ç—É—Ç –¥–µ–ø–ª–æ–∏—Ç–µ —á—Ç–æ –ª–∏? –ê —è —Å–≤–æ—é –≤–µ—Ç–∫—É –ø–æ—Å—Ç–∞–≤–∏–ª –¥–µ–ø–ª–æ–∏—Ç—å—Å—è.
>
> 11:41:09. **–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ 1:** ...!
>
> 11:41:14. **CTO:** ...!

–≠—Ç–æ –Ω–µ –ø—Ä–∏–¥—É–º–∞–Ω–Ω—ã–π –¥–∏–∞–ª–æ–≥. –ü—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫–æ–π —á–∞—Ç —Å–æ—Å—Ç–æ—è–ª—Å—è —É –Ω–∞—Å –≤ Campfire –≤ 2011
–≥–æ–¥—É.

–ß—Ç–æ —Ç—É—Ç —Å–∫–∞–∂–µ—à—å? –ü—Ä–æ—Ü–µ—Å—Å, –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—â–∏–π –º–Ω–æ–≥–∏—Ö, –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞–≥–ª—è–¥–Ω—ã–º –¥–ª—è –≤—Å–µ—Ö!
–ò–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É –≤ –∞—ç—Ä–æ–ø–æ—Ä—Ç–∞—Ö —Ä–µ–π—Å—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –Ω–∞ –±–æ–ª—å—à–∏—Ö –∑–∞–º–µ—Ç–Ω—ã—Ö —Ç–∞–±–ª–æ,
–∞ –Ω–µ —Ç–æ–ª—å–∫–æ –≤ –º–∞–ª–µ–Ω—å–∫–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ –∞–≤–∏–∞–¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞.

–ï—Å–ª–∏ –º—ã —É–∂–µ —Å–æ–±—Ä–∞–ª–∏—Å—å –≤ —ç—Ç–æ–º —á–∞—Ç–µ, —Ç–∞–∫ –¥–∞–≤–∞–π—Ç–µ –∑–¥–µ—Å—å –∏ –¥–µ–ø–ª–æ–∏—Ç—å!
–ò –ø—É—Å—Ç—å –≤—Å–µ —Å—Ç–∞–¥–∏–∏ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥—É—Ç –≤–∏–¥–Ω—ã –∑–¥–µ—Å—å –∂–µ. –î–∞–ª—å–Ω–µ–π—à–∞—è –∏—Å—Ç–æ—Ä–∏—è —Ä–∞—Å—Å–∫–∞–∂–µ—Ç,
–∫–∞–∫ —è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª —Ç–∞–∫—É—é —Å—Ö–µ–º—É.

–í–æ—Ç –∫–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Slack-—á–∞—Ç–µ [Shuttlerock](https://www.shuttlerock.com):

![–ü—Ä–∏–º–µ—Ä –¥–µ–ø–ª–æ—è](/assets/heroku-deploy/slack_rodney_deploy.png){:width="771"}

{% if false %}
–ê –≤–æ—Ç –µ—â—ë:

![–ü—Ä–∏–º–µ—Ä –¥–µ–ø–ª–æ—è 2](/assets/heroku-deploy/slack_rodney_deploy_2.png){:width="768"}
{% endif %}

–í–æ–∑–º–æ–∂–Ω–æ, –º–æ—ë —Ä–µ—à–µ–Ω–∏–µ –æ–∫–∞–∂–µ—Ç—Å—è –ø–æ–ª–µ–∑–Ω—ã–º –∏ –¥–ª—è –≤–∞—Å!

### Heroku

–í –ø—Ä–æ–µ–∫—Ç–∞—Ö –º—ã –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º Heroku. –ö–∞–∫ –∏ –≤—Å—ë –Ω–∞ —Å–≤–µ—Ç–µ,
—Å–µ—Ä–≤–∏—Å Heroku –∏–º–µ–µ—Ç —Å–≤–æ–∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏. –û–Ω –æ–±—Ö–æ–¥–∏—Ç—Å—è –¥–æ—Ä–æ–∂–µ,
—á–µ–º –∞—Ä–µ–Ω–¥–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ DigitalOcean, –Ω–æ —ç—Ç–æ –ø–ª–∞—Ç–∞ –∑–∞ —Ç–æ, —á—Ç–æ
DevOps-–∏–Ω–∂–µ–Ω–µ—Ä—ã Heroku –Ω–µ —Å–ø—è—Ç –Ω–æ—á—å—é, –∞ –≤—ã –º–æ–∂–µ—Ç–µ —Å–ø–∞—Ç—å.

–î–µ–ø–ª–æ–π –≤ Heroku —É—Å—Ç—Ä–æ–µ–Ω –ø—Ä–æ—Å—Ç–æ: `git push` ‚Äì –∏ –ø–æ–Ω–µ—Å–ª–∞—Å—å. –ß–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è
–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É–∂–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏–ª–æ—Å—å –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç. –ü–æ –∫—Ä–∞–π–Ω–µ–π –º–µ—Ä–µ, –≤ —Ç–µ–æ—Ä–∏–∏. –ê –Ω–∞
–ø—Ä–∞–∫—Ç–∏–∫–µ –µ—Å—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –Ω—é–∞–Ω—Å—ã, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –∏–º–µ—Ç—å –¥–µ–ª–æ.

#### –ù—é–∞–Ω—Å 1. Assets

–î–∞-–¥–∞, —ç—Ç–æ CSS, JS –∏ –∏—Ö –¥—Ä—É–∑—å—è. –ï—Å–ª–∏ –≤—ã, –Ω–µ –ø—Ä–∏–∫–ª–∞–¥—ã–≤–∞—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —É—Å–∏–ª–∏–π, –∑–∞–¥–µ–ø–ª–æ–∏—Ç–µ
–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Heroku, –æ–Ω–æ, –∫–æ–Ω–µ—á–Ω–æ, –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å. –ù–æ –≤—Å–µ assets –±—É–¥—É—Ç –æ—Ç–¥–∞–≤–∞—Ç—å—Å—è –∫–ª–∏–µ–Ω—Ç–∞–º
–∏–∑ Ruby, —Ç–æ –µ—Å—Ç—å –≤–∞—à–∏ –Ω–µ–¥–µ—à—ë–≤—ã–µ dynos –±—É–¥—É—Ç –∏–∑–æ–±—Ä–∞–∂–∞—Ç—å –∏–∑ —Å–µ–±—è Apache.
–í–æ-–ø–µ—Ä–≤—ã—Ö, —ç—Ç–æ –º–µ–¥–ª–µ–Ω–Ω–æ (–Ω–∞—Å—Ç–æ—è—â–∏–µ Apache –∏ nginx —Å–ø—Ä–∞–≤—è—Ç—Å—è –≥–æ—Ä–∞–∑–¥–æ –±—ã—Å—Ç—Ä–µ–µ). –í–æ-–≤—Ç–æ—Ä—ã—Ö,
–ø–æ–∫–∞ –∫–æ–¥ Rack –∑–∞—Ç–∞–ª–∫–∏–≤–∞–µ—Ç –≤ —Å–µ—Ç–µ–≤–æ–π –±—É—Ñ–µ—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ
`application.js`, –≤—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã —Å—Ç–æ—è—Ç –∏ –∂–¥—É—Ç. –û—á–µ–≤–∏–¥–Ω–æ, —Ç–∞–∫–∞—è —Å—Ö–µ–º–∞ –ø–æ–¥–æ–π–¥—ë—Ç
–ª–∏—à—å –¥–ª—è —Å–∞–π—Ç–∞ –≤–∞—à–µ–π —Ç—ë—â–∏, –Ω–æ –Ω–µ –±–æ–ª–µ–µ.

–ü–æ—ç—Ç–æ–º—É –≤—Å–µ _homo_, –∫–æ—Ç–æ—Ä—ã–µ _sapiens_, –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –æ—Ç–¥–∞—á–∏ assets –∏—Å–ø–æ–ª—å–∑—É—é—Ç CDN.
–ù–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–∫–∞—á–∏–≤–∞—é—Ç —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ assets –Ω–∞ S3 –∏ —Ä–∞–∑–¥–∞—é—Ç –∏—Ö –æ—Ç—Ç—É–¥–∞ —á–µ—Ä–µ–∑
CloudFront. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Å Rackspace –∏ –ø—Ä–æ—á–∏–º–∏ –æ–±–ª–∞—á–Ω—ã–º–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏. –ù–µ—Ç –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏ –Ω–∏—á–µ–≥–æ –ª—É—á—à–µ,
—á–µ–º CDN, ‚Äì –º–æ–∂–Ω–æ –ø—Ä–∏–Ω—è—Ç—å —ç—Ç–æ –∑–∞ –∞–∫—Å–∏–æ–º—É.

–ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ URL –¥–ª—è assets –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω—É–∂–¥–∞–µ—Ç—Å—è
–≤ —Ñ–∞–π–ª–µ-–º–∞–Ω–∏—Ñ–µ—Å—Ç–µ, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è `rake assets:precompile`.
–í Rails 4 —ç—Ç–æ—Ç —Ñ–∞–π–ª –ª–µ–∂–∏—Ç –≤ –∫–∞—Ç–∞–ª–æ–≥–µ `public/assets` –∏ –∏–º–µ–µ—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ —Å–ª–µ–¥—É—é—â–∏–π –≤–∏–¥:

{% highlight javascript %}
// public/assets/.sprockets-manifest-9b2e86e85245c42f19250388ba3e1a45.json
{
  "files": {
    "application-3dda9c3d8b35165ec9de63f4b471dc4ce898f16443b1c132aa5049128d8e9a1c.js": {
      "logical_path": "application.js",
      "mtime": "2015-10-07T11:22:21+06:00",
      "size": 341219,
      "digest": "3dda9c3d8b35165ec9de63f4b471dc4ce898f16443b1c132aa5049128d8e9a1c",
      "integrity": "sha256-PdqcPYs1Fl7J3mP0tHHcTOiY8WRDscEyqlBJEo2Omhw="
    },
    // ...
  },
  "assets": {
    "application.js": "application-3dda9c3d8b35165ec9de63f4b471dc4ce898f16443b1c132aa5049128d8e9a1c.js",
    // ...
  }
}
{% endhighlight %}

–ë–ª–∞–≥–æ–¥–∞—Ä—è –º–∞–Ω–∏—Ñ–µ—Å—Ç—É –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è `<%= javascript_include_tag :application %>`
–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å—Å—ã–ª–∫—É –Ω–∞ –∏–º—è —Ñ–∞–π–ª–∞ —Å –¥–ª–∏–Ω–Ω—ã–º —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω—ã–º —Ö–≤–æ—Å—Ç–æ–º. –ï—Å–ª–∏ —ç—Ç–æ—Ç —Ñ–∞–π–ª
–±—ã–ª –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω –Ω–∞ CDN, –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç.

–ö–∞–∫ —ç—Ç–æ –≤—Å—ë —É–≤—è–∑—ã–≤–∞–µ—Ç—Å—è —Å Heroku? –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –¥–µ–ø–ª–æ—è
Heroku –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–º–∞–Ω–¥—É `rake assets:precompile`, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞–ø–æ–ª–Ω—è–µ—Ç –∫–∞—Ç–∞–ª–æ–≥ `public/assets`
—Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ assets, –≤–∫–ª—é—á–∞—è –∏ –º–∞–Ω–∏—Ñ–µ—Å—Ç. –ù–æ –∫–∞–∫ —Ñ–∞–π–ª–∞–º –ø–æ–ø–∞—Å—Ç—å –Ω–∞ CDN? –ö–∞–∫
–æ–±–µ—Å–ø–µ—á–∏—Ç—å —Å—Ç–æ–ø—Ä–æ—Ü–µ–Ω—Ç–Ω—É—é –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞?

–ù–∞ —Ç–æ –±—ã–ª —Å–æ–∑–¥–∞–Ω –≥–µ–º [asset_sync](https://github.com/AssetSync/asset_sync). –û–Ω
–¥–æ–±–∞–≤–ª—è–µ—Ç —Å–≤–æ—é rake task, –∫–æ—Ç–æ—Ä–∞—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ—Å–ª–µ `rake assets:precompile` –∏ –∑–∞–ª–∏–≤–∞–µ—Ç
–≤—Å—ë –Ω–∞ S3. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –¥–µ–ø–ª–æ—è –ø–æ—Å–ª–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –ø—Ä—è–º–æ —Å –±–∏–ª–¥-—Å–µ—Ä–≤–µ—Ä–∞ Heroku
–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å S3.

–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —ç—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–∞–∫ —Å–µ–±–µ. –û–Ω–æ –æ—á–µ–Ω—å —Å–∏–ª—å–Ω–æ —É–¥–ª–∏–Ω—è–µ—Ç –≤—Ä–µ–º—è –¥–µ–ø–ª–æ—è,
–æ—Å–æ–±–µ–Ω–Ω–æ –≤ –±–æ–ª—å—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö. –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä assets, –≤–æ–æ–±—â–µ-—Ç–æ, —É–º–Ω—ã–π. –û–Ω –∫–µ—à–∏—Ä—É–µ—Ç —Å–≤–æ–∏
—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –∑–∞–Ω–æ–≤–æ —Ä–∞–±–æ—Ç—É –¥–µ–ª–∞—Ç—å –Ω–µ –±—É–¥–µ—Ç. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞:

{% highlight bash %}
rm -rf public/assets
time bin/rake assets:precompile
#> Writing ..... (–º–Ω–æ–≥–æ —Å—Ç—Ä–æ–∫ –ø—Ä–æ–ø—É—â–µ–Ω–æ)
#> bin/rake assets:precompile  0,19s user 0,10s system 5% cpu 5,191 total
time bin/rake assets:precompile
#> bin/rake assets:precompile  0,16s user 0,07s system 28% cpu 0,807 total
{% endhighlight %}

–í –ø—Ä–æ—Ü–µ—Å—Å–µ –≤—Ç–æ—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –Ω–µ –±—ã–ª–æ –∏–∑–º–µ–Ω–µ–Ω–æ –Ω–∏—á–µ–≥–æ. –û–¥–Ω–∞–∫–æ –Ω–∞ Heroku —ç—Ç–∏–º –∫—ç—à–µ–º
–≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è, –ø–æ—Ç–æ–º—É —á—Ç–æ –±–∏–ª–¥-—Å–µ—Ä–≤–µ—Ä –∫–∞–∂–¥—ã–π —Ä–∞–∑ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —á–∏—Å—Ç–æ–≥–æ –ª–∏—Å—Ç–∞.
–ü–æ–ª–Ω–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –±—É–¥–µ—Ç
–¥–µ–ª–∞—Ç—å—Å—è **–∫–∞–∂–¥—ã–π —Ä–∞–∑**, –¥–∞–∂–µ –µ—Å–ª–∏ –≤—ã assets –Ω–µ —Ç—Ä–æ–≥–∞–ª–∏. –ò —ç—Ç–æ –Ω–∞–ø—Ä—è–≥–∞–µ—Ç!

#### –ù—é–∞–Ω—Å 2. –ú–∏–≥—Ä–∞—Ü–∏–∏

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ SQL-–±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö, –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø—Ä–æ–≥–æ–Ω–∞
–º–∏–≥—Ä–∞—Ü–∏–π. –ù–æ –∏ –∑–¥–µ—Å—å —É Heroku –≤—Å—ë –Ω–µ–ø—Ä–æ—Å—Ç–æ. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç,
–≤–∞–º –Ω—É–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å `heroku run rake db:migrate` —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ. **–ù–æ**: –∏—Å–ø–æ–ª–Ω–∏—Ç—å
—ç—Ç—É –∫–æ–º–∞–Ω–¥—É –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ **–ø–æ—Å–ª–µ** –¥–µ–ø–ª–æ—è, –∫–æ–≥–¥–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã –≤ `db/migrate`
–±—É–¥—É—Ç –Ω–∞ –º–µ—Å—Ç–µ. –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –≤–æ–∑–º–æ–∂–µ–Ω —Å–ª—É—á–∞–π, –∫–æ–≥–¥–∞ —Ç–æ–ª—å–∫–æ —á—Ç–æ –∑–∞–¥–µ–ø–ª–æ–µ–Ω–Ω—ã–π Ruby-–∫–æ–¥ –±—É–¥–µ—Ç
—Å—Å—ã–ª–∞—Ç—å—Å—è –Ω–∞ –∞—Ç—Ä–∏–±—É—Ç –≤ –ë–î, –∫–æ—Ç–æ—Ä–æ–≥–æ –µ—â—ë –Ω–µ—Ç (–º–∏–≥—Ä–∞—Ü–∏—è –Ω–µ —É—Å–ø–µ–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç—å—Å—è);
—Ç–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–∏–¥–∏—Ç 500-—é –æ—à–∏–±–∫—É.

–ß—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —ç—Ç–æ–π –Ω–µ–ø—Ä–∏—è—Ç–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏, Heroku –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º –≤–∫–ª—é—á–∞—Ç—å
—Ä–µ–∂–∏–º maintenance. –ü–æ–ª–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫:

{% highlight bash %}
heroku maintenance:on
git push heroku master
heroku run rake db:migrate
heroku maintenance:off
heroku restart
{% endhighlight %}

`heroku restart` –Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —Å—Ö–µ–º–∞ –ë–î –±—ã–ª–∞ –ø–µ—Ä–µ—á–∏—Ç–∞–Ω–∞. –í
production-—Ä–µ–∂–∏–º–µ –æ–Ω–∞ —á–∏—Ç–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –Ω–∞ —Å—Ç–∞—Ä—Ç–µ, –∏ –µ—Å–ª–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ `users`
–Ω–µ –±—ã–ª–æ –ø–æ–ª—è `age`, —Ç–æ –º–µ—Ç–æ–¥—ã `User#age` –∏ `User#age=` –Ω–µ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã. –ò –¥–∞–∂–µ
–ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –º–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–æ–π–¥—ë—Ç –∏ –∫–æ–ª–æ–Ω–∫–∞ `age` –ø–æ—è–≤–∏—Ç—Å—è, –ª—é–±–æ–π –∫–æ–¥, –≤—ã–∑—ã–≤–∞—é—â–∏–π
—ç—Ç–∏ –º–µ—Ç–æ–¥—ã, —Ç–∞–∫ –∏ –±—É–¥–µ—Ç –ø–∞–¥–∞—Ç—å.

–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –¥–∞–∂–µ –≤ —ç—Ç–æ–π —Å—Ö–µ–º–µ –º–µ–∂–¥—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º `heroku maintenance:off` –∏
`heroku restart` –º–æ–∂–µ—Ç –ø—Ä–æ–ª–µ–∑—Ç—å –∫–∞–∫–æ–π-–Ω–∏–±—É–¥—å –Ω–µ—É–¥–∞—á–ª–∏–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏
—Å—Ö–ª–æ–ø–æ—Ç–∞—Ç—å —Å–≤–æ—é 500-—é. –ù–æ –∏–Ω–∞—á–µ –Ω–∏–∫–∞–∫.

–ê —Ç–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ assets –∫–æ–º–ø–∏–ª–∏—Ä—É—é—Ç—Å—è –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç ‚Äî
–≤–ø–æ–ª–Ω–µ —Ä–µ–∞–ª—å–Ω—ã–µ —Ü–∏—Ñ—Ä—ã –¥–ª—è –±–æ–ª—å—à–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
–ò –≤—Å—ë —ç—Ç–æ –≤—Ä–µ–º—è –º—ã –≤ —Ä–µ–∂–∏–º–µ maintenance!..

### –ü—É—Ç—å –∫ –∂–µ–ª–∞–µ–º–æ–π —Å–∏—Å—Ç–µ–º–µ

–ò—Ç–∞–∫, –º—ã –æ—á–µ—Ä—Ç–∏–ª–∏ –∫—Ä—É–≥ –ø—Ä–æ–±–ª–µ–º:

1. –ù–∞–≥–ª—è–¥–Ω–æ—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞ –¥–µ–ø–ª–æ—è.
2. –ö–æ–º–ø–∏–ª—è—Ü–∏—è assets –∏ –∑–∞–ª–∏–≤–∫–∞ –Ω–∞ CDN.
3. –ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–π.

–ü–æ—Ä–∞–∑–º—ã—à–ª—è–≤, —è –ø—Ä–∏—à—ë–ª –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ä–µ—à–µ–Ω–∏—é:

1. –í–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–Ω—É—Ç—Ä–∏ [Jenkins](https://jenkins-ci.org/), —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ
–Ω–∞ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–º VPS-—Å–µ—Ä–≤–µ—Ä–µ.
2. Assets –ø–æ–ª–Ω–æ—Å—Ç—å—é –∫–æ–º–ø–∏–ª–∏—Ä—É—é—Ç—Å—è –∏ –∑–∞–ª–∏–≤–∞—é—Ç—Å—è –Ω–∞ S3 **–ø–µ—Ä–µ–¥** –¥–µ–ø–ª–æ–µ–º. –ï—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π
–Ω–µ –±—ã–ª–æ (—á—Ç–æ –º–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –ø–æ –∏—Å—Ç–æ—Ä–∏–∏ git), —Ç–æ –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç—Å—è (–∞ —ç—Ç–æ –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ).
–ï—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è-—Ç–∞–∫–∏ –±—ã–ª–∏, `rake assets:precompile` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à, —á—Ç–æ —É–±—ã—Å—Ç—Ä—è–µ—Ç
–∫–æ–º–ø–∏–ª—è—Ü–∏—é.
3. –ó–∞–ø—É—Å–∫ –¥–µ–ø–ª–æ—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ [Hubot](https://hubot.github.com/) ‚Äî –±–æ—Ç–∞, –≤–∏—Å—è—â–µ–≥–æ –≤ —á–∞—Ç–µ
–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—â–µ–≥–æ —Å Jenkins. –û–Ω –∂–µ –æ–ø–æ–≤–µ—â–∞–µ—Ç –æ–± —É—Å–ø–µ—à–Ω–æ–º –∏–ª–∏ –Ω–µ—É—Å–ø–µ—à–Ω–æ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –¥–µ–ø–ª–æ—è.
4. –ü—Ä–æ–≥–æ–Ω –º–∏–≥—Ä–∞—Ü–∏–π —è–≤–ª—è–µ—Ç—Å—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º. –í–≤–æ–¥–∏—Ç—Å—è –¥–≤–∞ —Ä–µ–∂–∏–º–∞ –¥–µ–ø–ª–æ—è: **–æ–±—ã—á–Ω—ã–π** (–ø—Ä–∏–≤–µ–¥—ë–Ω–Ω—ã–π –≤—ã—à–µ
–ø–æ–ª–Ω—ã–π —Å–∫—Ä–∏–ø—Ç —Å –≤–∫–ª—é—á–µ–Ω–∏–µ–º —Ä–µ–∂–∏–º–∞ maintenance) –∏ **–±—ã—Å—Ç—Ä—ã–π**, –∫–æ–≥–¥–∞ –º–∏–≥—Ä–∞—Ü–∏–∏
–Ω–µ –ø—Ä–æ–≥–æ–Ω—è—é—Ç—Å—è –≤–æ–æ–±—â–µ.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Å–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —á–∞—Å—Ç–µ–π:

1. Hubot.
2. –ö–∞—Å—Ç–æ–º–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è Hubot, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–π –∫–æ–º–∞–Ω–¥—É deploy –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—â–∏–π
—Å Jenkins.
3. –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∏ —Ä–∞–±–æ—Ç–∞—é—â–∏–π Jenkins —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —Å–±–æ—Ä–∫–∞–º–∏.
4. Bash-—Å–∫—Ä–∏–ø—Ç `bin/deploy` –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ï–≥–æ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–±–æ—Ä–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç Jenkins.
5. –ú–æ–¥—É–ª—å –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ assets —Å S3 –≤–Ω—É—Ç—Ä–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

–î–∞–≤–∞–π—Ç–µ –Ω–µ–º–Ω–æ–≥–æ –æ–±—Å—É–¥–∏–º —ç—Ç–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —á–∞—Å—Ç–∏.

#### Hubot

–Ø –≤–ª—é–±–∏–ª—Å—è –≤ Hubot —Å –ø–µ—Ä–≤–æ–≥–æ –≤–∑–≥–ª—è–¥–∞ –∏ –∏—Å–ø–æ–ª—å–∑—É—é –µ–≥–æ –≤ –∫–∞–∂–¥–æ–º –ø—Ä–æ–µ–∫—Ç–µ. –ú–æ–∏ –ª—é–±–∏–º—ã–µ
–∫–æ–º–∞–Ω–¥—ã –ø–æ–º–∏–º–æ `deploy` ‚Äî —ç—Ç–æ [`image`](https://github.com/hubot-scripts/hubot-google-images) –∏ [`excuse`](https://github.com/github/hubot-scripts/blob/master/src/scripts/excuse.coffee).

–ü–æ —Å—É—Ç–∏, Hubot –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —É–¥–æ–±–Ω—ã–π –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫ –≤–∞—à–µ–º—É —á–∞—Ç—É –≤ [Slack](https://slack.com/)
([HipChat](https://www.hipchat.com/), [Campfire](https://campfirenow.com/)).
–ù–∞–ø–∏—Å–∞—Ç—å JS-–∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –∫–æ–º–∞–Ω–¥—ã, –Ω–µ—Ç—Ä—É–¥–Ω–æ.

–°–∞–º Hubot –ª–µ–≥–∫–æ –¥–µ–ø–ª–æ–∏—Ç—Å—è –Ω–∞ Heroku.

#### Jenkins

Jenkins ‚Äì¬†—ç—Ç–æ —Ç–æ—Ç –µ—â—ë Java-–º–æ–Ω—Å—Ç—Ä. –û–¥–Ω–∞–∫–æ –æ–Ω —Å—Ç–∞–±–∏–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –∫ –Ω–µ–º—É –µ—Å—Ç—å –æ—á–µ–Ω—å –º–Ω–æ–≥–æ
–ø–ª–∞–≥–∏–Ω–æ–≤. –°–≤–æ–π –ø–ª–∞–≥–∏–Ω –Ω–∞–ø–∏—Å–∞—Ç—å –Ω–µ —Ç–∞–∫ –ø—Ä–æ—Å—Ç–æ, –∫–∞–∫ –¥–ª—è Hubot, –Ω–æ –æ–±–æ–π–¥—ë–º—Å—è.
–ò—Ç–∞–∫, —á—Ç–æ –∂–µ —Ö–æ—Ä–æ—à–µ–≥–æ –Ω–∞–º –¥–∞—ë—Ç Jenkins?

* _–ü—Ä–æ–∑—Ä–∞—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å Git._ Jenkins –º–æ–∂–µ—Ç —Å–∫–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π, –≤—ã–±—Ä–∞—Ç—å –∏ –æ–±–Ω–æ–≤–∏—Ç—å –Ω—É–∂–Ω—É—é –≤–µ—Ç–∫—É.
* _–ò—Å—Ç–æ—Ä–∏—è —Å–±–æ—Ä–æ–∫ —Å –ª–æ–≥–∞–º–∏._ –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≥–æ–Ω–∞ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –≤—Å–µ–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º,
–¥–æ–ø—É—â–µ–Ω–Ω—ã–º –≤ Jenkins.
* _–û—á–µ—Ä–µ–¥—å —Å–±–æ—Ä–æ–∫._ –ï—Å–ª–∏ –ø–æ—Å—Ç—É–ø–∏–ª–æ –ø–æ–¥—Ä—è–¥ –¥–≤–µ –∫–æ–º–∞–Ω–¥—ã –Ω–∞ –¥–µ–ø–ª–æ–π, –≤—Ç–æ—Ä–∞—è –≤—Å—Ç–∞–Ω–µ—Ç –≤ –æ—á–µ—Ä–µ–¥—å –∏ –ø–æ–¥–æ–∂–¥—ë—Ç, –ø–æ–∫–∞
–ø–µ—Ä–≤–∞—è –∑–∞–∫–æ–Ω—á–∏—Ç —Å–≤–æ—é —Ä–∞–±–æ—Ç—É. –ï—Å–ª–∏ –≤—Ç–æ—Ä–∞—è –±—ã–ª–∞ –¥–∞–Ω–∞ —Å–ª—É—á–∞–π–Ω–æ, –º–æ–∂–Ω–æ —É—Å–ø–µ—Ç—å –∑–∞–π—Ç–∏ –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Jenkins –∏ –æ—Ç–º–µ–Ω–∏—Ç—å –µ—ë.
* _–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç—å —Å–±–æ—Ä–æ–∫_. –ï—Å–ª–∏ —É –≤–∞—Å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏–ª–∏ –≤–µ—Ä—Å–∏–π –æ–¥–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (staging, production),
–¥–µ–ø–ª–æ–π –±—É–¥–µ—Ç –∏–¥—Ç–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ.

–ü–æ —Å—É—Ç–∏, Jenkins ‚Äî —ç—Ç–æ —Å—É–ø–µ—Ä-–±–æ–≥–∞—Ç–∞—è –æ–±–æ–ª–æ—á–∫–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ bash-—Å–∫—Ä–∏–ø—Ç–æ–≤.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–ü–µ—Ä–µ–π–¥—ë–º –∂–µ –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–∏—é. –ù–∏–∂–µ –±—É–¥–µ—Ç –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞—Ç—å—Å—è, —á—Ç–æ
Heroku-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è _coolapp_.

#### Jenkins

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Jenkins –Ω–µ—Å–ª–æ–∂–Ω–æ. –í –ø–æ—Å–ª–µ–¥–Ω–µ–º –ø—Ä–æ–µ–∫—Ç–µ —è –¥–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª [ansible](http://www.ansible.com/),
–≤–∑—è–≤ –≥–æ—Ç–æ–≤—É—é —Ä–æ–ª—å [Stouts.jenkins](https://github.com/Stouts/Stouts.jenkins).
–ù–∞–º –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –ø–ª–∞–≥–∏–Ω—ã:

* [GIT plugin](http://wiki.jenkins-ci.org/display/JENKINS/Git+Plugin).
* [Build Authorization Token Root Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Build+Token+Root+Plugin).
–ù—É–∂–µ–Ω –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ HTTP-–∑–∞–ø—Ä–æ—Å–æ–º –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–±–æ—Ä–∫—É (–¥–µ–ø–ª–æ–π) —Å–Ω–∞—Ä—É–∂–∏.
* [Notification plugin](https://wiki.jenkins-ci.org/display/JENKINS/Notification+Plugin). –ü–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è
—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è Hubot –æ –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–±–æ—Ä–∫–∏.

–Ø —Ç–∞–∫–∂–µ —Å—Ç–∞–≤–ª—é [Green Balls](http://wiki.jenkins-ci.org/display/JENKINS/Green+Balls) –¥–ª—è –∫—Ä–∞—Å–æ—Ç—ã,
[ChuckNorris Plugin](https://wiki.jenkins-ci.org/display/JENKINS/ChuckNorris+Plugin) –¥–ª—è –ø—Ä–∏–∫–æ–ª–∞,
[Matrix Authorization Strategy Plugin](http://wiki.jenkins-ci.org/display/JENKINS/Matrix+Authorization+Strategy+Plugin)
–¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–æ–º, [Credentials Plugin](http://wiki.jenkins-ci.org/display/JENKINS/Credentials+Plugin)
–¥–ª—è –∑–∞–¥–∞–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–ª—é—á–µ–π –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º
 –∏ [SCM Sync Configuration Plugin](http://wiki.jenkins-ci.org/display/JENKINS/SCM+Sync+configuration+plugin)
–¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥–æ–≤ Jenkins –≤ git.

–£ —Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø–æ–¥ –∫–æ—Ç–æ—Ä—ã–º –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å Jenkins (–æ–±—ã—á–Ω–æ —ç—Ç–æ `jenkins`),
–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä—ã Ruby –≤—Å–µ—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –≤–µ—Ä—Å–∏–π. –î–ª—è —ç—Ç–æ–≥–æ
–æ–∫–∞–∑–∞–ª–∞—Å—å –ø–æ–ª–µ–∑–Ω–æ–π [ansible-—Ä–æ–ª—å zzet.rbenv](https://github.com/zzet/ansible-rbenv-role).

–£–±–µ–¥–∏–≤—à–∏—Å—å, —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç, –º–æ–∂–Ω–æ –ø—Ä–∏—Å—Ç—É–ø–∞—Ç—å –∫ —Å–æ–∑–¥–∞–Ω–∏—é —Å–±–æ—Ä–∫–∏. –î–∞–¥–∏–º –µ–π
–æ—Å–º—ã—Å–ª–µ–Ω–Ω–æ–µ –∏–º—è:

![–ó–∞–¥–∞–Ω–∏–µ –∏–º–µ–Ω–∏ –¥–ª—è —Å–±–æ—Ä–∫–∏](/assets/heroku-deploy/jenkins_name.png){:width="343"}

–ö–∞–∂–¥–∞—è –≤–µ—Ä—Å–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (staging, production, ‚Ä¶) –ø–æ—Ç—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å–±–æ—Ä–∫–∏. –ó–∞—Ç–µ–º –¥–æ–±–∞–≤–∏–º
–Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é:

![–ù–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è](/assets/heroku-deploy/jenkins_notify.png){:width="482"}

–í –ø–æ–ª–µ URL –¥–æ–ª–∂–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –ø–æ–ª–Ω—ã–π –∞–¥—Ä–µ—Å Hubot —Å–æ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–º –ø—É—Ç—ë–º:
–Ω–∞–ø—Ä–∏–º–µ—Ä, `https://my-hubot-instance.herokuapp.com/hubot/jenkins_status`.

–ù–∏–∂–µ –Ω—É–∂–Ω–æ –ø–æ—Å—Ç–∞–≤–∏—Ç—å –≥–∞–ª–∫—É ¬´–ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å–±–æ—Ä–∫–∞¬ª. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –º—ã —Å–æ–∑–¥–∞–¥–∏–º,
—Å –æ–¥–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã —Å–∫—Ä–∏–ø—Ç—É —Å–±–æ—Ä–∫–∏ –∫–∞–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è,
–∞, —Å –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –∏—Ö –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∏–∑–≤–Ω–µ,
–∑–∞–ø—É—Å–∫–∞—è —Å–±–æ—Ä–∫—É –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º HTTP POST-–∑–∞–ø—Ä–æ—Å–∞. –ü–æ–Ω–∞–¥–æ–±—è—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

|-----------+-----------+---------------------+--------------|
| –ò–º—è       | –¢–∏–ø       | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á.  | –û–ø–∏—Å–∞–Ω–∏–µ     |
|-----------+-----------+---------------------+--------------|
| APP       | –°—Ç—Ä–æ–∫–∞    | `coolapp-staging`   | –ò–º—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Heroku |
| BRANCH    | –°—Ç—Ä–æ–∫–∞    | `master`            | –ò–º—è –≤–µ—Ç–∫–∏ |
| DEPLOYER  | –°—Ç—Ä–æ–∫–∞    | _(–ø—É—Å—Ç–æ)_           | –ò–Ω–∏—Ü–∏–∞—Ç–æ—Ä –¥–µ–ø–ª–æ—è |
| QUICK     | –ë—É–ª–µ–≤.    | –≤—ã–∫–ª.               | –ë—ã—Å—Ç—Ä—ã–π —Ä–µ–∂–∏–º ‚Äî –±–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–π |
| EXTRA     | –°—Ç—Ä–æ–∫–∞    | _(–ø—É—Å—Ç–æ)_           | –î–æ–ø. –ø–∞—Ä–∞–º–µ—Ç—Ä—ã |
|-----------+-----------+---------------------+--------------|
{: .table}

–í —Ä–∞–∑–¥–µ–ª–µ ¬´Source Code Management¬ª —Å–ª–µ–¥—É–µ—Ç –≤—ã–±—Ä–∞—Ç—å Git –∏ —É–∫–∞–∑–∞—Ç—å –∞–¥—Ä–µ—Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è,
–∞ –≤ –ø–æ–ª–µ –≤—ã–±–æ—Ä–∞ –≤–µ—Ç–∫–∏ –ø–æ—Å—Ç–∞–≤–∏—Ç—å `origin/$BRANCH`:

![–ù–∞—Å—Ç—Ä–æ–π–∫–∞ SCM](/assets/heroku-deploy/jenkins_scm.png){:width="544"}

–≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –Ω–∞–º –¥–µ–ø–ª–æ–∏—Ç—å –ª—é–±—É—é –≤–µ—Ç–∫—É, –∫–æ—Ç–æ—Ä–∞—è –µ—Å—Ç—å –≤ Git.

–í —Ä–∞–∑–¥–µ–ª–µ ¬´Build Triggers¬ª –∑–∞–¥–∞–π—Ç–µ —Ç–æ–∫–µ–Ω –¥–ª—è –≤–Ω–µ—à–Ω–µ–π —Å–≤—è–∑–∏, –∞ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –≥–∞–ª–∫–∏
–æ—Ç–∫–ª—é—á–∏—Ç–µ:

![Build Triggers](/assets/heroku-deploy/jenkins_build_trigger.png){:width="422"}

–û—Å—Ç–∞–Ω–µ—Ç—Å—è –ª–∏—à—å –¥–æ–±–∞–≤–∏—Ç—å —à–∞–≥ —Å–±–æ—Ä–∫–∏ (¬´Execute Shell¬ª):

{% highlight bash %}
# –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ Ruby. –ù–µ –∑–∞–±—É–¥—å—Ç–µ —É–∫–∞–∑–∞—Ç—å –≤–µ—Ä—Å–∏—é
# –≤ –≤–∞—à–µ–º Gemfile! –ù–∞–ø—Ä–∏–º–µ—Ä, ruby '2.2.3'
ruby_version=`grep '^ruby' Gemfile|cut -d "'" -f 2`

# –î–æ–º–∞—à–Ω–∏–π –∫–∞—Ç–∞–ª–æ–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è jenkins ‚Äì /var/lib/jenkins. –ï—Å–ª–∏ —É –≤–∞—Å –¥—Ä—É–≥–æ–π,
# –ø–æ–ø—Ä–∞–≤—å—Ç–µ.
export PATH=/var/lib/jenkins/.rbenv/versions/$ruby_version/bin:/var/lib/jenkins/.rbenv/shims:$PATH
export HOME=/var/lib/jenkins

# –î–µ–ª–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä EXTRA –¥–æ—Å—Ç—É–ø–Ω—ã–º –≤–Ω—É—Ç—Ä–∏ bin/deploy.sh
export EXTRA

# –ê —ç—Ç–æ –∫–ª—é—á–∏ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è –∑–∞–∫–∞—á–∫–∏ assets –Ω–∞ S3:
export AWS_ACCESS_KEY_ID=<–∫–ª—é—á>
export AWS_SECRET_ACCESS_KEY=<—Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á>
export AWS_BUCKET=coolapp-prod-assets

# –ó–∞–¥–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
export RAILS_ENV=staging

# –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –≤–µ—Ä—Å–∏—è—Ö Rails –∫–æ–º–∞–Ω–¥–∞ rake assets:precompile –∑–∞—á–µ–º-—Ç–æ —Ç—Ä–µ–±—É–µ—Ç
# —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –ë–î. –û–∫–∞–∑–∞–ª–æ—Å—å –ª–µ–≥—á–µ —É—Å—Ç—É–ø–∏—Ç—å, –¥–ª—è —á–µ–≥–æ —è —Å–æ–∑–¥–∞–ª –ø—É—Å—Ç—É—é –ë–î
# –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è jenkins —Å –ø–∞—Ä–æ–ª–µ–º jenkins.
export DATABASE_URL=postgresql://jenkins:jenkins@127.0.0.1/jenkins_empty

# –ü—Ä–∏—à–ª–æ—Å—å —Å—Ç–æ–ª–∫–Ω—É—Ç—å—Å—è –∏ —Å —Ç–µ–º, —á—Ç–æ Devise —Ç—Ä–µ–±—É–µ—Ç –∫–ª—é—á. –•–æ—Ç—è –º—ã –≤—Å–µ–≥–æ –ª–∏—à—å
# –¥–µ–ª–∞–µ–º rake assets:precompile! –ö–∞–∫ –≥–ª–∞—Å–∏—Ç –º—É–¥—Ä–æ—Å—Ç—å, –∑–∞–Ω—É–¥–µ –ª–µ–≥—á–µ –æ—Ç–¥–∞—Ç—å—Å—è‚Ä¶
export DEVISE_SECRET_KEY=fb02df94e6fb4

# –≠—Ç–∏ –∫–æ–º–∞–Ω–¥—ã –±—É–¥—É—Ç –ø–æ–ª–µ–∑–Ω—ã, –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å. –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ
# –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:

#env
#gem env
#bundle env

if [[ -f bin/deploy.sh ]]; then
    exec bin/deploy.sh
else
    false
fi
{% endhighlight %}

–ò—Ç–∞–∫, –∑–¥–µ—Å—å –º—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Å—Ä–µ–¥—É –∏ –ø–µ—Ä–µ–¥–∞—ë–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç—É
`bin/deploy.sh`.

–ö —Å–ª–æ–≤—É —Å–∫–∞–∑–∞—Ç—å, –µ—Å–ª–∏ –≤—ã —Å–æ–∑–¥–∞—ë—Ç–µ –≤—Ç–æ—Ä—É—é, —Ç—Ä–µ—Ç—å—é –∏ —Ç.–¥. —Å–±–æ—Ä–∫—É, –Ω–µ –∑–∞–±–∏–≤–∞–π—Ç–µ
–≤—Å—ë –∑–∞–Ω–æ–≤–æ, –∞ –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å —Ä–µ–∂–∏–º–æ–º –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è:

![–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–±–æ—Ä–∫–∏](/assets/heroku-deploy/jenkins_copy.png){:width="725"}

–ê –ø–æ–∫–∞ –≤–æ–∑—å–º—ë–º—Å—è –∑–∞ Hubot.

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Hubot

Hubot —Å—Ç–∞–≤–∏—Ç—Å—è [–ø–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏](https://hubot.github.com/docs/). –ö—Å—Ç–∞—Ç–∏, –ø–æ–¥–±–µ—Ä–∏—Ç–µ
–ø–æ–¥—Ö–æ–¥—è—â–µ–µ –∏–º—è –¥–ª—è –±–æ—Ç–∞ –≤–º–µ—Å—Ç–æ ¬´hubot¬ª. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ Shuttlerock —É –Ω–∞—Å –µ–≥–æ
–∑–æ–≤—É—Ç _rodney_.

–í –∫–∞—Ç–∞–ª–æ–≥ scripts –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª
[deploy.coffee](https://gist.github.com/be9/87727f2f41c8709036e2#file-deploy-coffee). –≠—Ç–∞
–≤–µ—Ä—Å–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è Slack, –¥–ª—è –¥—Ä—É–≥–∏—Ö –∞–¥–∞–ø—Ç–µ—Ä–æ–≤ –º–æ–≥—É—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∫–∏.

–í `deploy.coffee` –≤–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–º–µ–Ω—è—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É:

{% highlight coffee %}
APPS = ['production', 'staging']
{% endhighlight %}

–£–∫–∞–∂–∏—Ç–µ –∑–¥–µ—Å—å –≤—Å–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏/–∏–ª–∏ –∏—Ö –≤–µ—Ä—Å–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –±—É–¥–µ—Ç–µ –¥–µ–ø–ª–æ–∏—Ç—å. –ù–∞–ø—Ä–∏–º–µ—Ä,
—ç—Ç–∞ —Å—Ç—Ä–æ–∫–∞ –º–æ–≥–ª–∞ –±—ã –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫:

{% highlight coffee %}
APPS = ['production', 'staging', 'monitoring production', 'monitoring staging']
{% endhighlight %}

–ó–¥–µ—Å—å –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞—é—Ç—Å—è –¥–≤–µ –≤–µ—Ä—Å–∏–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –¥–≤–µ –≤–µ—Ä—Å–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
monitoring.

–û—Å—Ç–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–µ–ª–∞—é—Ç—Å—è –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
—É –∏–Ω—Å—Ç–∞–Ω—Å–∞ Hubot. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã –¥–µ–ø–ª–æ—è.

1. –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `HUBOT_JENKINS_URL` –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–æ–ª–Ω—ã–π –∞–¥—Ä–µ—Å Jenkins (–Ω–∞–ø—Ä–∏–º–µ—Ä,
`https://jenkins.example.com`).

2. –î–ª—è `HUBOT_JENKINS_BUILD_TOKEN` –∑–∞–¥–∞–π—Ç–µ
–∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –≤—ã —É–∫–∞–∑—ã–≤–∞–ª–∏ –ø—Ä–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–±–æ—Ä–∫–∏ (–≤ –Ω–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ —ç—Ç–æ
`0W5CT73cFV4ia89N9Sa87S644v3twA9P`). –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ —ç—Ç–æ—Ç —Ç–æ–∫–µ–Ω –æ–¥–∏–Ω–∞–∫–æ–≤
–¥–ª—è –≤—Å–µ—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏ –∏—Ö –≤–µ—Ä—Å–∏–π.

3. –¢–µ–ø–µ—Ä—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–∑ –º–∞—Å—Å–∏–≤–∞ `APPS` –∑–∞–¥–∞–π—Ç–µ —á–µ—Ç—ã—Ä–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:
* `HUBOT_PRODUCTION_APP`. –≠—Ç–æ –∏–º—è Heroku-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –í –Ω–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ `coolapp-staging`.
* `HUBOT_PRODUCTION_DEFAULT_BRANCH`. –í–µ—Ç–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –¥–µ–ø–ª–æ–∏—Ç—å—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–µ—Å–ª–∏ —è–≤–Ω–æ –Ω–µ —É–∫–∞–∑–∞–Ω–∞).
   –ù–∞–ø—Ä–∏–º–µ—Ä, `master`.
* `HUBOT_PRODUCTION_JOB`. –ò–º—è —Å–±–æ—Ä–∫–∏ —É Jenkins. –£ –Ω–∞—Å —ç—Ç–æ `coolapp-staging-deploy`.
* `HUBOT_PRODUCTION_ACL`. –≠—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —É–ø—Ä–∞–≤–ª—è–µ—Ç –¥–æ—Å—Ç—É–ø–æ–º –∫ –¥–µ–ø–ª–æ—é. –ó–¥–µ—Å—å
–Ω—É–∂–Ω–æ –∑–∞–¥–∞—Ç—å –ª–∏–±–æ —Å–ø–∏—Å–æ–∫ E-mail –¥–æ–ø—É—â–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é, –ª–∏–±–æ `everyone`.
–†–µ–∞–ª—å–Ω—ã–µ E-mail –∞–¥—Ä–µ—Å–∞ –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞ `hubot show users`.

–ò–º–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–ª—É—á–∞—é—Ç—Å—è –∏–∑ –∏–º–µ–Ω–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è _monitoring staging_
–æ–Ω–∏ –±—É–¥—É—Ç –Ω–∞–∑—ã–≤–∞—Ç—å—Å—è `HUBOT_MONITORING_STAGING_APP` –∏ —Ç.–¥.

–ò—Ç–∞–∫, –µ—Å–ª–∏ –≤—Å—ë —Å–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤–µ—Ä–Ω–æ, –∫–æ–º–∞–Ω–¥–∞ –±–æ—Ç—É (`hubot deploy to staging`)
–∑–∞–ø—É—Å—Ç–∏—Ç –Ω–∞ Jenkins —Å–±–æ—Ä–∫—É —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏. –¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ
–ø–æ—Å–º–æ—Ç—Ä–∏–º –≤ —Å–∞–º—É—é —Å–µ—Ä–¥—Ü–µ–≤–∏–Ω—É –ø—Ä–æ—Ü–µ—Å—Å–∞ ‚Äî –Ω–∞ —Å–∫—Ä–∏–ø—Ç `deploy.sh`.

#### bin/deploy.sh

–°–∫—Ä–∏–ø—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ç–æ–º –∂–µ [gist](https://gist.github.com/be9/87727f2f41c8709036e2#file-deploy-sh),
–Ω–æ –¥–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä—ë–º, —á—Ç–æ —Ç–∞–º –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç. –ü–æ–π–¥—ë–º –ø–æ –æ—Ç–¥–µ–ª—å–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏—è–º.

**set_extra_flags**

{% highlight bash %}
set_extra_flags() {
  if [[ "$EXTRA" =~ 'reupload assets' ]]; then
    export CLOUD_ASSETS_REUPLOAD=1
  fi

  if [[ "$EXTRA" =~ 'recompile assets' ]]; then
    export CLOUD_ASSETS_RECOMPILE=1
  fi

  if [[ "$EXTRA" =~ 'cleanup assets' ]]; then
    export CLOUD_ASSETS_REMOTE_DELETE=1
  fi

  if [[ "$EXTRA" =~ 'skip heroku' ]]; then
    export SKIP_HEROKU=1
  fi

  if [[ "$EXTRA" =~ 'clear cache' ]]; then
    export CLEAR_CACHE=1
  fi
}
{% endhighlight %}

–ó–¥–µ—Å—å –≤–∏–¥–Ω–æ, –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ¬´—Ö–≤–æ—Å—Ç¬ª –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç—É: –≤ –Ω—ë–º –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å
–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã. –ü—Ä–æ—Å—Ç–æ –∫–æ–º–∞–Ω–¥–∞ `hubot deploy to staging` ‚Äî
—ç—Ç–æ –æ–¥–Ω–æ. –ê –µ—Å–ª–∏ –≤—ã –Ω–∞–±–µ—Ä—ë—Ç–µ `hubot deploy to staging and recompile assets and clear cache`,
–±—É–¥—É—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `CLOUD_ASSETS_RECOMPILE` –∏ `CLEAR_CACHE`, —á—Ç–æ –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å
(—Å–º. –¥–∞–ª—å—à–µ).

**compile_assets**

{% highlight bash %}
compile_assets() {
  current_sha=`git log -n 1 --pretty=format:%H app/assets vendor/assets`

  if [[ -f public/assets/CURRENT_SHA && `cat public/assets/CURRENT_SHA` == $current_sha && "$CLOUD_ASSETS_REUPLOAD" == '' && "$CLOUD_ASSETS_RECOMPILE" == '' ]]; then
    echo "Assets did not change (SHA $current_sha)"
  else
    echo "Recompiling assets"

    bundle install --quiet --without=test

    rm -rf public/assets

    time bundle exec rake assets:precompile cloud_assets:sync

    echo $current_sha > public/assets/CURRENT_SHA
  fi
}
{% endhighlight %}

–í —Ñ–∞–π–ª–µ `public/assets/CURRENT_SHA` –ª–µ–∂–∏—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç, –∏–∑–º–µ–Ω—è–≤—à–∏–π —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `app/assets` –∏–ª–∏ `vendor/assets` (–µ—Å–ª–∏
–≤–∞—à–∏ assets –ª–µ–∂–∞—Ç –≥–¥–µ-—Ç–æ –µ—â—ë, –¥–æ–±–∞–≤—å—Ç–µ —ç—Ç–∏ –∫–∞—Ç–∞–ª–æ–≥–∏ –≤ –∞—Ä–≥—É–º–µ–Ω—Ç—ã `git log`). –ï—Å–ª–∏
–∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–µ –±—ã–ª–æ, —Ç–æ –Ω–∏—á–µ–≥–æ –ø–µ—Ä–µ–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–µ –±—É–¥–µ—Ç.

–í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–µ—Ä–µ–∫–æ–º–ø–∏–ª—è—Ü–∏—è (–¥–ª—è –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
  `rm -rf public/assets`, —Ö–æ—Ç—è —ç—Ç–æ –∏ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º) –∏ –∑–∞–ª–∏–≤–∫–∞ –Ω–∞ S3.

–ß—Ç–æ–±—ã –∑–∞–ª–∏–≤–∫–∞ —Ä–∞–±–æ—Ç–∞–ª–∞, –¥–æ–±–∞–≤—å—Ç–µ –≤ –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞ —Ñ–∞–π–ª—ã
[lib/tasks/cloud_assets.rake](https://gist.github.com/be9/87727f2f41c8709036e2#file-cloud_assets-rake)
–∏ [lib/fog_cloud_assets.rb](https://gist.github.com/be9/87727f2f41c8709036e2#file-fog_cloud_assets-rb).
–î–ª—è —Ä–∞–±–æ—Ç—ã –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ç–∞–∫–∂–µ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –≥–µ–º fog_aws, –Ω–µ –∑–∞–±—É–¥—å—Ç–µ –µ–≥–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ `Gemfile`:

{% highlight ruby %}
gem 'fog-aws', require: 'fog/aws'
{% endhighlight %}

–ú–æ–¥—É–ª—å FogCloudAssets –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—É—é –∑–∞–∫–∞—á–∫—É —Ñ–∞–π–ª–æ–≤ –Ω–∞ S3.
–ï—Å–ª–∏ —Ä–µ–∂–∏–º `recompile assets`, –∫–∞–∫ –º—ã –≤–∏–¥–µ–ª–∏ –≤—ã—à–µ, –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç –ø–æ–ª–Ω—É—é –ø–µ—Ä–µ–∫–æ–º–ø–∏–ª—è—Ü–∏—é,
—Ç–æ `reupload assets` –¥–µ–ª–∞–µ—Ç –ø–æ–ª–Ω—É—é –∑–∞–∫–∞—á–∫—É –Ω–∞ S3: –∑–∞–ª–∏–≤–∞–µ—Ç—Å—è –¥–∞–∂–µ —Ç–æ, —á—Ç–æ —É–∂–µ –µ—Å—Ç—å.
–ê `cleanup assets` —É–¥–∞–ª—è–µ—Ç –≤—Å–µ assets, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ —Ç–µ–∫—É—â–µ–º –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ.

**save_deploy_information** –∏ **commit**

–ò–∑-–∑–∞ —Ç–æ–≥–æ, —á—Ç–æ –º—ã –∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º assets –¥–æ –¥–µ–ø–ª–æ—è, –≤—Å—Ç–∞—ë—Ç –≤–æ–ø—Ä–æ—Å, –∫–∞–∫ –æ–±–µ—Å–ø–µ—á–∏—Ç—å
–Ω–∞–ª–∏—á–∏–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞ –≤ –∑–∞–¥–µ–ø–ª–æ–µ–Ω–Ω–æ–º –∫–æ–¥–µ. –Ø
—Ä–µ—à–∏–ª —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å —Ç–∞–∫: –ø—Ä–∏ –∫–∞–∂–¥–æ–º –¥–µ–ø–ª–æ–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω–∞—è –≤–µ—Ç–∫–∞,
–∫—É–¥–∞ –≤ `public/assets` –∫–æ–º–º–∏—Ç–∏—Ç—Å—è —Ñ–∞–π–ª –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞, –∞ –ø—Ä–∏ –¥–µ–ø–ª–æ–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
`git push --force`. Heroku –∂–µ, —É–≤–∏–¥–µ–≤ —ç—Ç–æ—Ç –º–∞–Ω–∏—Ñ–µ—Å—Ç, –Ω–µ –±—É–¥–µ—Ç
–≤—ã–∑—ã–≤–∞—Ç—å `rake assets:precompile`.  

–≠—Ç–æ –Ω–µ –æ—á–µ–Ω—å —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ, –∑–∞—Ç–æ –¥–∞—ë—Ç –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏. –§—É–Ω–∫—Ü–∏—è `save_deploy_information`,
–Ω–∞–ø—Ä–∏–º–µ—Ä, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ñ–∞–π–ª `lib/deploy_info.rb` —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞:

{% highlight ruby %}
module DeployInfo
  BRANCH='feature/5852-core-can-upload-to-boards-via-the-api-when-submissions-false'
  GIT_COMMIT='833a167e8bfd747816eb7337a45394f288ce813f'
  BUILD_NUMBER='1217'
  BUILD_ID='1217'
  DEPLOYER='dave'

  def message
    return @message if defined?(@message)
    text = File.read(__FILE__)
    text =~ /[_]_END__(.*)$/m
    @message = ($1 || '').strip
  end

  module_function :message
end
__END__
commit 833a167e8bfd747816eb7337a45394f288ce813f
Author: John Doe <johndoe@example.org>
Date:   Thu Nov 12 18:02:04 2015 +0300

    #5852: Updated specs for Api::V1::BoardItemsController
{% endhighlight %}

–ê —ç—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ –ø–æ–Ω—è—Ç—å, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –∑–∞–¥–µ–ø–ª–æ–µ–Ω–æ. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º
[ActiveAdmin](https://github.com/active_admin/active_admin):

{% highlight ruby %}
# app/admin/dashboards.rb
ActiveAdmin.register_page "Dashboard" do
  content do
    # ...

    columns do
      # ...

      column do
        panel "Deploy Information" do
          require 'deploy_info'

          github = "https://github.com/CoolCompany/coolapp/"

          attributes_table_for DeployInfo do
            row('Branch')       { link_to DeployInfo::BRANCH, "#{github}tree/#{DeployInfo::BRANCH}" }
            row('Commit')       { link_to DeployInfo::GIT_COMMIT, "#{github}commit/#{DeployInfo::GIT_COMMIT}" }
            row('Build Number') { DeployInfo::BUILD_NUMBER }
            row('Build ID')     { DeployInfo::BUILD_ID }
            row('Deployer')     { DeployInfo::DEPLOYER }
            row(:message)       { pre DeployInfo.message }
          end
        end # panel
      end # column
    end # columns
  end # content
{% endhighlight %}

–ü–æ–ª—É—á–∞–µ—Ç—Å—è –¥–æ–≤–æ–ª—å–Ω–æ –∫—Ä–∞—Å–∏–≤–æ:

![–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–¥–µ–ø–ª–æ–µ–Ω–Ω–æ–º –∫–æ–¥–µ –≤ ActiveAdmin](/assets/heroku-deploy/active_admin_deploy_info.png){:width="1035"}

–ß—Ç–æ–±—ã ActiveAdmin –Ω–µ –ø–∞–¥–∞–ª –ø—Ä–∏ –ª–æ–∫–∞–ª—å–Ω–æ–º –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –ø–æ–ª–æ–∂–∏—Ç–µ –≤ –¥–µ—Ä–µ–≤–æ –∏—Å—Ö–æ–¥–Ω—ã—Ö –∫–æ–¥–æ–≤
—Ç–∞–∫–æ–π `lib/deploy_info.rb`:

{% highlight ruby %}
# NOTE: –≠—Ç–æ—Ç —Ñ–∞–π–ª –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –¥–µ–ø–ª–æ—è!
module DeployInfo
  BRANCH=`git rev-parse --abbrev-ref HEAD`.strip
  GIT_COMMIT=`git rev-parse HEAD`.strip
  BUILD_NUMBER='dev'
  BUILD_ID='dev'
  DEPLOYER=`git config user.name`.strip

  def message
    `git log -1 --pretty=medium`.strip
  end

  module_function :message
end
{% endhighlight %}

–†–∞—Å—Å–º–æ—Ç—Ä–µ–≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏, –ø–µ—Ä–µ–π–¥—ë–º –∫ –∏–∑—É—á–µ–Ω–∏—é –æ–±—â–µ–π –ª–æ–≥–∏–∫–∏ –¥–µ–ø–ª–æ—è.

**–û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ bin/deploy.sh**

{% highlight bash %}
set_extra_flags
compile_assets
save_deploy_information
commit

if [ "$QUICK" = "true" ]; then

    if [[ "$SKIP_HEROKU" == '' ]]; then
      git_push
    else
      echo "Skipping heroku push as requested"
    fi

    #if [[ "$CLEAR_CACHE" == '1' ]]; then
    #  echo "Clearing cache per request"
    #  heroku run rake cache:clear --app $APP
    #fi

    echo "QUICK mode, not running migrations"
else
    if [[ "$SKIP_HEROKU" == '' ]]; then
      heroku maintenance:on --app $APP

      git_push

      heroku run rake db:migrate --app $APP #cache:clear db:migrate --app $APP

      heroku maintenance:off --app $APP

      heroku restart --app $APP
    else
      echo "Skipping heroku push as requested"
    fi
fi
{% endhighlight %}

–ó–¥–µ—Å—å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `QUICK` –º—ã –∏–¥—ë–º –ª–∏–±–æ –ø–æ –∫–æ—Ä–æ—Ç–∫–æ–º—É, –ª–∏–±–æ –ø–æ –¥–ª–∏–Ω–Ω–æ–º—É –ø—É—Ç–∏.
–ü–æ–º–∏–º–æ —ç—Ç–æ–≥–æ –ø–æ–∫–∞–∑–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –≤–µ—â–∏:

* –†–µ–∂–∏–º `skip heroku` –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å –∏ –∑–∞–ª–∏—Ç—å assets, –Ω–æ –Ω–µ —Ç—Ä–æ–≥–∞—Ç—å Heroku.
–ö—Ä–∞–π–Ω–µ —Ä–µ–¥–∫–æ, –Ω–æ –±—ã–≤–∞–µ—Ç –Ω—É–∂–Ω–æ.
* –£ –Ω–∞—Å –≤ —Ç–µ–∫—É—â–µ–º –ø—Ä–æ–µ–∫—Ç–µ `rake cache:clear` [–≤—ã–∑—ã–≤–∞–µ—Ç `Rails.cache.clear`](https://gist.github.com/be9/87727f2f41c8709036e2#file-cache-rake).
–í –∑–∞–∫–æ–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —á–∞—Å—Ç–∏ –ø–æ–∫–∞–∑–∞–Ω–æ, –∫–∞–∫ —ç—Ç–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è. –ü–æ–ª–Ω—ã–π –¥–µ–ø–ª–æ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
–≤—ã–∑—ã–≤–∞–µ—Ç `cache:clear` –≤–º–µ—Å—Ç–µ —Å `db:migrate`, –∞ –≤ –±—ã—Å—Ç—Ä–æ–º —Ä–µ–∂–∏–º–µ –º–æ–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å –±–æ—Ç—É `... and clear cache`.

–°–ª–µ–¥—É—è —ç—Ç–æ–π –ª–æ–≥–∏–∫–µ, –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ñ–ª–∞–≥–∏ –¥–ª—è –¥–µ–ø–ª–æ—è.
–î–ª—è —ç—Ç–æ–≥–æ –Ω–µ –ø—Ä–∏–¥—ë—Ç—Å—è —Ç—Ä–æ–≥–∞—Ç—å –Ω–∏ Hubot, –Ω–∏ Jenkins, –∞ –ª–∏—à—å –¥–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É
–≤ `bin/deploy.sh`.

### –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∫–æ–º–∞–Ω–¥–æ–π deploy

–ò—Ç–∞–∫, –≤—ã –≤—Å—ë –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏. –ß—Ç–æ –º–æ–∂–Ω–æ —Ç–µ–ø–µ—Ä—å –¥–µ–ª–∞—Ç—å?

`hubot deploy to production` –¥–µ–ø–ª–æ–∏—Ç production (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ—Ç–∫–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).

`hubot quick deploy feature/something-really-cool to staging` –¥–µ–ø–ª–æ–∏—Ç —É–∫–∞–∑–∞–Ω–Ω—É—é –≤–µ—Ç–∫—É (`feature/‚Ä¶`) –Ω–∞ staging
–≤ –±—ã—Å—Ç—Ä–æ–º —Ä–µ–∂–∏–º–µ, –±–µ–∑ –ø—Ä–æ–≥–æ–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏–π.

`hubot deploy to production and recompile assets` –¥–µ–ø–ª–æ–∏—Ç production, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
 –ø–µ—Ä–µ–∫–æ–º–ø–∏–ª–∏—Ä—É—è assets, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–∏ —Å –ø—Ä–æ—à–ª–æ–≥–æ —Ä–∞–∑–∞ –Ω–µ –º–µ–Ω—è–ª–∏—Å—å.

`hubot disable deploys to staging` –≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–ø—Ä–µ—â–∞–µ—Ç –¥–µ–ø–ª–æ–π –Ω–∞ staging (–ø–æ–ª–µ–∑–Ω–æ,
–µ—Å–ª–∏ –≤–µ–¥—É—Ç—Å—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã –∏–ª–∏ –≤—ã –≥–ª—É–±–æ–∫–æ –≤ –æ—Ç–ª–∞–¥–∫–µ –∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ,
—á—Ç–æ–±—ã –≤–∞–º –º–µ—à–∞–ª–∏). –ú–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –ø—Ä–∏—á–∏–Ω—É:
`hubot disable deploys to staging because it hurts`.

`hubot enable deploys to staging` –≤–∫–ª—é—á–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–µ–ø–ª–æ—è –æ–±—Ä–∞—Ç–Ω–æ.

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –¥–ª—è —É—Å—Ç–æ–π—á–∏–≤–æ–π —Ä–∞–±–æ—Ç—ã –ø–æ–ª–µ–∑–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∫ Hubot —Ö—Ä–∞–Ω–∏–ª–∏—â–µ Redis
—Å –ø–æ–º–æ—â—å—é –ø–ª–∞–≥–∏–Ω–∞ [hubot-redis-brain](https://github.com/hubot-scripts/hubot-redis-brain).

### –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü–æ–ª—É—á–∏–ª–∞—Å—å –∫–ª–∞—Å—Å–Ω–∞—è –º–æ–¥—É–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–µ–ø–ª–æ—è! –ï—ë –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –¥–ª—è Rails:

* –£–¥–æ–±–Ω—ã–π –∏ —É–ø—Ä–∞–≤–ª—è–µ–º—ã–π –¥–µ–ø–ª–æ–π –Ω–∞ Heroku.
* –ö–æ–º–ø–∏–ª—è—Ü–∏—è assets –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—Ç–¥–µ–ª—å–Ω–æ –∏ –Ω–µ –∑–∞–º–µ–¥–ª—è–µ—Ç –¥–µ–ø–ª–æ–π. –ï—Å–ª–∏ assets –Ω–µ –º–µ–Ω—è–ª–∏—Å—å,
–Ω–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏—é –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –≤—Ä–µ–º—è –Ω–µ —Ç—Ä–∞—Ç–∏—Ç—Å—è –≤–æ–æ–±—â–µ.

–ù–æ —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ Rails! –û–±—â–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –¥–ª—è –≤—Å–µ—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π:

* –í—Å–µ –ø–æ–Ω–∏–º–∞—é—Ç, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç.
* –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏—Å—Ç–æ—Ä–∏—è —É—Å–ø–µ—à–Ω—ã—Ö –∏ –Ω–µ—É—Å–ø–µ—à–Ω—ã—Ö –ø—Ä–æ–≥–æ–Ω–æ–≤.
* –î–µ–ø–ª–æ–∏—Ç—å –º–æ–∂–µ—Ç –ª—é–±–æ–π —á–µ–ª–æ–≤–µ–∫, –∫–æ–º—É —ç—Ç–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ, –≤ —Ç.—á. –Ω–æ–≤–∏—á–æ–∫ –∏–ª–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫,
–∫–æ—Ç–æ—Ä–æ–º—É —Ç—Ä—É–¥–Ω–æ –∏ –¥–æ–ª–≥–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –∏ –æ–±–Ω–æ–≤–ª—è—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (Heroku Toolbelt,
Ruby, bundler, node.js –∏ –ø—Ä–æ—á.).
* –î–µ–ø–ª–æ–∏—Ç—å –º–æ–∂–Ω–æ –ª—é–±—ã–µ –≤–µ—Ç–∫–∏ Git.
* –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Å–∫—Ä–∏–ø—Ç –Ω–µ—Å–ª–æ–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å –¥–ª—è –ª—é–±–æ–π —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏.

–í Shuttlerock –º—ã —Å—Ç–∞–ª–∏ –¥–µ–ø–ª–æ–∏—Ç—å —Å –ø–æ–º–æ—â—å—é —Å–∏—Å—Ç–µ–º—ã –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –¥–µ–ø–ª–æ—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞
[angular.js](https://angularjs.org/) —Å –ø–æ–º–æ—â—å—é [bower](http://bower.io/) –∏ [gulp](http://gulpjs.com/)
–Ω—É–∂–Ω–æ –±—ã–ª–æ –ª–∏—à—å –Ω–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Å–∫—Ä–∏–ø—Ç.

–ú–æ–∏ –∫–æ–ª–ª–µ–≥–∏ –≥–æ–≤–æ—Ä—è—Ç, —á—Ç–æ —ç—Ç–æ —Å–∞–º–∞—è –ª—É—á—à–∞—è —Å–∏—Å—Ç–µ–º–∞, –∫–æ—Ç–æ—Ä—É—é –∏–º –¥–æ–≤–æ–¥–∏–ª–æ—Å—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å.
–Ø –∏–º –≤–µ—Ä—é üòÑ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏ –≤—ã!
